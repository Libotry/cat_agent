# é”™é¢˜æœ¬ â€” åç«¯/Agent

### DEV-11 è·¨æ¨¡å—è¯­ä¹‰å‡è®¾ä¸ä¸€è‡´ï¼ˆ"åœ¨çº¿"å®šä¹‰ï¼‰ `ğŸŸ¢`

âŒ æ¨¡å— A æ”¹å˜äº†æ ¸å¿ƒæ¦‚å¿µå«ä¹‰ï¼ˆAgent ä»"è‡ªå·±è¿ WebSocket"å˜æˆ"æœåŠ¡ç«¯é©±åŠ¨"ï¼‰ï¼Œä¾èµ–è¯¥æ¦‚å¿µçš„æ¨¡å— B æ²¡åŒæ­¥æ›´æ–°
âœ… å½“æ¶æ„å†³ç­–æ”¹å˜æŸä¸ªæ¦‚å¿µçš„è¯­ä¹‰æ—¶ï¼Œå›æº¯æ‰€æœ‰ä¾èµ–è¯¥æ¦‚å¿µçš„æ¨¡å—ï¼Œæ›´æ–°å…¶å‰æå‡è®¾
> TDD ä¸­åº”æ˜ç¡®åˆ—å‡ºè·¨æ¨¡å—ä¾èµ–å‡è®¾ã€‚æ¡ˆä¾‹ï¼šDEV-BUG-5ã€‚

#### DEV-BUG-5 @æåŠå”¤é†’è¦æ±‚ Agent æœ‰ WebSocket è¿æ¥ `ğŸŸ¢`

- **åœºæ™¯**: äººç±» @å°æ˜ å‘æ¶ˆæ¯ï¼ŒæœŸæœ›å°æ˜è‡ªåŠ¨å›å¤
- **ç°è±¡**: æ¶ˆæ¯å‘å‡ºåæ— å›å¤ï¼Œå”¤é†’å¼•æ“é™é»˜è·³è¿‡
- **åŸå› **: `wakeup_service.process` ä¸­ @æåŠå¿…å”¤è¦æ±‚ `aid in online_agent_ids`ï¼Œè€Œ Agent æ˜¯æœåŠ¡ç«¯é©±åŠ¨çš„
- **ä¿®å¤**: @æåŠå¿…å”¤å»æ‰ `in online_agent_ids` æ£€æŸ¥

#### DEV-BUG-6 OpenClaw BotCiv Plugin è¿æ¥åå¤æ–­å¼€ï¼ˆè€—æ—¶ 1.5hï¼‰ `ğŸŸ¢`

- **åœºæ™¯**: ç¼–å†™ OpenClaw botciv channel plugin
- **æ ¹å› **: ä¸‰å±‚å åŠ  â€” Node 22 åŸç”Ÿ WS ä¸ Starlette ä¸å…¼å®¹ + ws æ¨¡å—è·¯å¾„æ‰¾ä¸åˆ° + oc_bot.py æŠ¢è¿æ¥
- **ä¿®å¤**: `createRequire` ç»å¯¹è·¯å¾„åŠ è½½ ws + æ€æ—§å®¢æˆ·ç«¯ + ä¿®æ¶ˆæ¯æ ¼å¼
- **è¯¦ç»†å¤ç›˜**: [postmortem-dev-bug-6.md](../postmortems/postmortem-dev-bug-6.md)

#### DEV-BUG-8 WebSocket å¹¿æ’­ e2e æµ‹è¯•æ”¶ä¸åˆ° Agent å›å¤ `ğŸŸ¢`

- **åœºæ™¯**: e2e æµ‹è¯•é€šè¿‡ WebSocket å‘é€äººç±»æ¶ˆæ¯ï¼Œç­‰å¾… Agent å›å¤å¹¿æ’­
- **æ ¹å› **: websockets v16 åŒå‘ ping ç«äº‰ â€” LLM è°ƒç”¨è€—æ—¶ ~23s è¶…è¿‡ ping_interval(20s)
- **ä¿®å¤**: e2e æµ‹è¯• `websockets.connect()` å¢åŠ  `ping_interval=None` + `broadcast()` å¢åŠ å¼‚å¸¸æ—¥å¿—

#### DEV-BUG-9 ST æš´éœ² batch wakeup ä¸¤ä¸ª mock ç›²åŒº `ğŸŸ¢`

- **åœºæ™¯**: M2 Phase 4 å®Œæˆåé¦–æ¬¡æ‹‰èµ·çœŸå®æœåŠ¡å™¨è°ƒç”¨ batch wakeup API
- **æ ¹å› **: mock æŠŠçœŸå®çº¦æŸæ›¿æ¢æˆç†æƒ³å€¼
- **ä¿®å¤**: dev endpoint ä¼ªé€  `online_ids |= {0}` + Agent model æ”¹ä¸ºæ³¨å†Œè¡¨ä¸­çš„æ¨¡å‹
- **è¯¦ç»†å¤ç›˜**: [postmortem-dev-bug-9.md](../postmortems/postmortem-dev-bug-9.md)

#### DEV-BUG-12 Agent model å­—æ®µä¸ MODEL_REGISTRY ä¸åŒ¹é…å¯¼è‡´é™é»˜ `ğŸŸ¢`

- **åœºæ™¯**: E2E æµ‹è¯• @Alice å”¤é†’æˆåŠŸä½†æ— å›å¤
- **æ ¹å› **: Alice model=`gpt-4o-mini` ä¸åœ¨ MODEL_REGISTRYï¼Œ`resolve_model` è¿”å› None â†’ é™é»˜
- **ä¿®å¤**: æ”¹ model ä¸ºæ³¨å†Œè¡¨ä¸­çš„ `stepfun/step-3.5-flash`
- **è¯¦ç»†å¤ç›˜**: [postmortem-dev-bug-12.md](../postmortems/postmortem-dev-bug-12.md)

#### DEV-BUG-14 OpenRouter å…è´¹æ¨¡å‹é™æµå¯¼è‡´ wakeup é™é»˜å¤±è´¥ `ğŸŸ¢`

- **åœºæ™¯**: wakeup-model é…ç½® `google/gemma-3-12b-it:free`ï¼ŒAgent å”¤é†’æµç¨‹æ— å“åº”
- **æ ¹å› **: OpenRouter å…è´¹æ¨¡å‹é¢‘ç¹ 429 é™æµï¼Œ`call_wakeup_model` æ•è·å¼‚å¸¸è¿”å› "NONE" â†’ é™é»˜è·³è¿‡
- **ä¿®å¤**: æ”¹ä¸ºä»˜è´¹ç‰ˆ `google/gemma-3-12b-it`ï¼Œå»æ‰ `:free` åç¼€
- **é˜²èŒƒ**: å…è´¹æ¨¡å‹åªç”¨äºå¼€å‘è°ƒè¯•ï¼Œç”Ÿäº§/demo åœºæ™¯å¿…é¡»ç”¨ä»˜è´¹æ¨¡å‹
- **è°ƒç”¨æ”¾å¤§é—®é¢˜**: 1 æ¡ @3äººæ¶ˆæ¯ â†’ 7~9 æ¬¡/åˆ†é’Ÿï¼Œç›´æ¥æ’ 20 RPM å¢™
