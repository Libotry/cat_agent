# é”™é¢˜æœ¬ â€” ğŸ’» å¼€å‘è€… / é€šç”¨å¼€å‘ï¼ˆå‰åç«¯å…±ç”¨ï¼‰

> **è®°å½•è§„åˆ™**ï¼šæœ¬æ–‡ä»¶åªè®°å½•è·¨å‰åç«¯çš„é€šç”¨æ•™è®­ï¼ˆåŒç»ˆç«¯åˆ†å·¥ã€æ¥å£å¥‘çº¦ã€å·¥å…·è°ƒç”¨ç­–ç•¥ã€å¤–éƒ¨ CLI é›†æˆã€Git æµç¨‹ã€Code Review æµç¨‹ç­‰ï¼‰ã€‚çº¯å‰ç«¯é—®é¢˜å†™ `error-book-dev-frontend.md`ï¼Œçº¯åç«¯é—®é¢˜å†™ `error-book-dev-backend.md`ã€‚æ¯æ¡æ§åˆ¶åœ¨ **5 è¡Œä»¥å†…**ï¼ˆâŒ/âœ…/ä¸€å¥è¯æ ¹å› ï¼‰ï¼Œè¯¦ç»† checklist å’Œå¤ç›˜æ”¾ `postmortems/postmortem-dev-bug-N.md`ï¼Œé”™é¢˜æœ¬é‡Œåªæ”¾é“¾æ¥ã€‚

---

### DEV-1 åç«¯ç»ˆç«¯æ”¹äº†å‰ç«¯æ–‡ä»¶

âŒ åç«¯ç»ˆç«¯ä¿®æ”¹ `web/src/components/Chat.tsx`
âœ… åç«¯ç»ˆç«¯åªæ”¹ `server/`ï¼Œå‰ç«¯é—®é¢˜é€šçŸ¥å‰ç«¯ç»ˆç«¯å¤„ç†
> èŒè´£åˆ†ç¦»ï¼Œé¿å…å†²çªã€‚

### DEV-2 æ”¹æ¥å£æ²¡æ›´æ–°å¥‘çº¦æ–‡æ¡£

âŒ åç«¯æ”¹äº† `/api/agents` çš„è¿”å›æ ¼å¼ï¼Œæ²¡æ›´æ–° `docs/api-contract.md`
âœ… æ”¹æ¥å£çš„åŒæ—¶æ›´æ–° `docs/api-contract.md`ï¼Œé€šçŸ¥å‰ç«¯ç»ˆç«¯
> api-contract.md æ˜¯å‰åç«¯å”¯ä¸€çš„åä½œè¾¹ç•Œã€‚

### DEV-3 è”è°ƒé—®é¢˜ç”¨åŒç»ˆç«¯æ¥å›æ’æŸ¥

âŒ WebSocket æ¶ˆæ¯æ”¶ä¸åˆ°ï¼Œå‰ç«¯ç»ˆç«¯æŸ¥ä¸€éã€åç«¯ç»ˆç«¯æŸ¥ä¸€éï¼Œæ¥å›æ²Ÿé€š
âœ… è·¨å±‚é—®é¢˜ç”¨ Agent Team è”è°ƒï¼ˆåè°ƒè€… + å‰ç«¯è°ƒè¯•è€… + åç«¯è°ƒè¯•è€…ï¼‰
> ç®€å•é—®é¢˜å•ç»ˆç«¯ä¿®ï¼Œè·¨å±‚é—®é¢˜ç”¨ Agent Teamã€‚

### DEV-4 å¤æ‚åŠŸèƒ½è·³è¿‡éœ€æ±‚è¯„å®¡

âŒ ç›´æ¥å¼€å§‹å†™ä»£ç ï¼Œæ²¡æœ‰ REQ æ–‡æ¡£
âœ… æ–°åŠŸèƒ½å…ˆèµ°å››æ–¹éœ€æ±‚è¯„å®¡ï¼ˆé˜¶æ®µ1ï¼‰ï¼Œäº§å‡º REQ-XXX.md
> ç®€å• Bug å¯ä»¥è·³è¿‡ï¼Œå¤æ‚åŠŸèƒ½å¿…é¡»è¯„å®¡ã€‚

### DEV-5 å®æ–½ä¸éµå¾ª TDD æ–‡æ¡£

âŒ TDD å®šä¹‰äº†æ¥å£æ ¼å¼ï¼Œå®æ–½æ—¶è‡ªå·±æ”¹äº†å­—æ®µå
âœ… ä¸¥æ ¼æŒ‰ TDD å®æ–½ï¼Œéœ€è¦æ”¹è®¾è®¡å…ˆæ›´æ–° TDD å†æ”¹ä»£ç 
> TDD æ˜¯å¥‘çº¦ï¼Œæ”¹å¥‘çº¦éœ€è¦èµ°æµç¨‹ã€‚

### DEV-6 ä¿®å¤ä»£ç æ—¶åªçœ‹ bug ç‚¹ï¼Œä¸åšå½±å“é¢åˆ†æ

âŒ æ”¹äº†å˜é‡èµ‹å€¼è¯­ä¹‰ï¼ˆå¢é‡â†’è¦†ç›–ï¼‰ï¼Œæ²¡æœ‰æ£€æŸ¥ä¸‹æ¸¸å¼•ç”¨æ˜¯å¦ä»æˆç«‹ï¼Œå¯¼è‡´æ­»ä»£ç ã€è¯­ä¹‰çŸ›ç›¾
âœ… ä¿®å¤å‰ grep æ‰€æœ‰å¼•ç”¨ç‚¹ï¼Œé€ä¸ªç¡®è®¤æ”¹åŠ¨åè¯­ä¹‰æ˜¯å¦æˆç«‹ï¼›æ”¹å®Œååš"æ¶Ÿæ¼ªæ¨æ¼”"
> è¯¦è§ [postmortem-dev-bug-6.md](../postmortems/postmortem-dev-bug-6.md)

### DEV-7 æŠŠ pytest å•å…ƒæµ‹è¯•å½“æˆ STï¼ˆç³»ç»Ÿæµ‹è¯•ï¼‰éªŒè¯

âŒ è¢«è¦æ±‚"å¯åŠ¨ ST æµ‹è¯•"æ—¶ï¼Œç›´æ¥è·‘ `pytest tests/`ï¼Œå£°ç§°"å…¨ç»¿=éªŒè¯é€šè¿‡"
âœ… UT=pytest mockï¼›ST=å¯åŠ¨ uvicorn + curl çœŸå® APIï¼›E2E=å‰åç«¯è”è°ƒ + Playwright
> å•å…ƒæµ‹è¯•å…¨ç»¿åªèƒ½è¯æ˜ mock ç¯å¢ƒä¸‹é€»è¾‘æ­£ç¡®ï¼Œä¸èƒ½è¯æ˜çœŸå®ç¯å¢ƒå¯ç”¨ã€‚

### DEV-8 Write å·¥å…·è°ƒç”¨ç¼ºå°‘ content å‚æ•°åå¤å¤±è´¥ï¼ˆâš ï¸ äºŒæ¬¡å¤çŠ¯ï¼‰

âŒ é•¿æ–‡æ¡£ç”Ÿæˆæ—¶è¿ç»­å‘ç©º Write è°ƒç”¨ï¼ˆæ—  contentï¼‰ï¼ŒäºŒæ¬¡å¤çŠ¯
âœ… Write è°ƒç”¨å‰å…ˆç¡®è®¤ content å·²å°±ç»ªï¼Œæ²¡å°±ç»ªå°±ä¸å‘ï¼›å¤±è´¥åè¯»é”™è¯¯ä¿¡æ¯ä¿®æ­£ï¼Œè¿ç»­ 2 æ¬¡åŒä¸€é”™è¯¯ â†’ æ¢æ€è·¯

### DEV-9 AR å®Œæˆåè·³è¿‡ä¸²è®²ç›´æ¥ç¼–ç 

âŒ TDD-M3 å®Œæˆåç›´æ¥åˆ›å»ºç¼–ç ä»»åŠ¡ï¼Œè·³è¿‡é˜¶æ®µ 3/4/5ï¼ˆä¸²è®² + æµ‹è¯•ç”¨ä¾‹è®¾è®¡ï¼‰
âœ… AR å®ŒæˆåæŒ‰ `development-workflow.md` ç»§ç»­ï¼šæ­£å‘ä¸²è®² â†’ åå‘ä¸²è®² â†’ æµ‹è¯•ç”¨ä¾‹è®¾è®¡ â†’ æ‰èƒ½ç¼–ç 
> CLAUDE.md å·¥ä½œæµåŸæ¥åªå†™åˆ° AR é—¨æ§å°±æ–­äº†ï¼Œå·²è¡¥å…¨å®Œæ•´é“¾è·¯ï¼ˆDEV-9 ä¿®å¤ï¼‰ã€‚

### DEV-10 E2E æµ‹è¯• fixture åª create_all ä¸å…ˆ drop_all â†’ UNIQUE å†²çª

âŒ `setup_db` ç”¨ `Base.metadata.create_all` ä½†ä¸å…ˆæ¸…ç†ï¼Œç”Ÿäº§ DB å·²æœ‰æ•°æ®æ—¶ seed æ’å…¥å†²çª
âœ… fixture å…ˆ `drop_all` å† `create_all`ï¼Œä¿è¯æ¯ä¸ªæµ‹è¯•ä»ç©ºè¡¨å¼€å§‹
> æµ‹è¯•éš”ç¦»æ˜¯åŸºæœ¬åŠŸã€‚create_all å¯¹å·²å­˜åœ¨çš„è¡¨æ˜¯ no-opï¼Œä¸ä¼šæ¸…æ•°æ®ã€‚

### DEV-11 å‰åç«¯å­—æ®µå¯¹é½é ç›®æµ‹ â†’ è¿è¡Œæ—¶æ‰å‘ç°ä¸åŒ¹é…

âŒ å‰ç«¯ types.ts å‡­è®°å¿†å†™å­—æ®µï¼Œä¸é€å­—æ®µæ¯”å¯¹åç«¯ schema
âœ… å†™å®Œ types.ts åé€å­—æ®µæ¯”å¯¹ï¼šå­—æ®µåã€ç±»å‹ã€å¯é€‰æ€§ã€æšä¸¾å€¼ï¼Œåˆ—è¡¨æ ¼ç¡®è®¤
> å­—æ®µåå·®ä¸€ä¸ªå­—æ¯ = è¿è¡Œæ—¶ undefinedã€‚M3 å¯¹é½éªŒè¯ checklistï¼šJobâ†”JobOutã€ShopItemâ†”ItemOutã€WsSystemEventâ†”broadcast payloadã€‚

### DEV-13 ç”¨æˆ·è¯´"ç”¨ CLI"ï¼Œä»ç„¶è‡ªè¡Œç»•è·¯ç›´æ¥æ‰“ REST API

âŒ ç”¨æˆ·æ˜ç¡®è¯´"ç”¨ gemini cli"ï¼Œè„šæœ¬é‡Œè¿˜æ˜¯ç”¨ fetch æ‰“ RESTï¼›CLI æŠ¥é”™å°±è½¬ API key ç»•è·¯
âœ… "ç”¨ CLI"= subprocess æ˜¯å”¯ä¸€è·¯å¾„ï¼ŒCLI æŠ¥é”™ â†’ æŠ¥ç»™ç”¨æˆ·ï¼Œä¸ç»•è·¯ï¼›æ˜ç¡®æŒ‡å®š `-m` é¿å…é»˜è®¤ Pro è€— quota
> ç”¨æˆ·æŒ‡å®šçš„å·¥å…· = ç¡¬çº¦æŸï¼Œä¸æ˜¯"ä¼˜å…ˆé¡¹"ã€‚è¯¦è§ [postmortem-dev-bug-10.md](../postmortems/postmortem-dev-bug-10.md)

### DEV-12 å¤–éƒ¨ CLI é›†æˆï¼šè·³è¿‡ç¯å¢ƒæ¢é’ˆ + è¯¯åˆ¤é”™è¯¯ä¿¡æ¯ â†’ å¤§é‡æ— æ•ˆè½®æ¬¡

âŒ ç›´æ¥å†™è„šæœ¬é‡åˆ° PATH/ä»£ç†/è®¤è¯/quota é€ä¸ªè¡¥æ•‘ï¼Œå…± 25+ è½®ï¼›429 `limit:0` è¯¯åˆ¤ä¸º"ç”¨å°½"
âœ… é›†æˆå¤–éƒ¨ CLI å‰å…ˆåš 4 æ­¥æ¢é’ˆï¼šâ‘  which â‘¡ HTTPS_PROXY â‘¢ è®¤è¯é…ç½® â‘£ æ‰‹åŠ¨æµ‹ä¸€æ¡å‘½ä»¤
âœ… 429 æœ‰ retryDelay = RPM é™åˆ¶ï¼ˆç­‰ï¼‰ï¼›æ—  = çœŸç”¨å°½ã€‚æ¶‰åŠ"åˆ é™¤"å…ˆç¡®è®¤èŒƒå›´
> è¯¦è§ [postmortem-dev-bug-10.md](../postmortems/postmortem-dev-bug-10.md)

### DEV-14 æ–°åŠŸèƒ½ç¼–ç ä¸å¤ç”¨å·²æœ‰ pattern â†’ Code Review å‡º P1/P2

âŒ ä¸ grep åŒç±»å®ç°ã€æ“…è‡ªåç¦» TDDã€try/except å˜é‡å¯è¾¾æ€§æœªæ£€æŸ¥ã€å†™å®Œä¸é€æ¡å¯¹ç…§ TDD è‡ªæŸ¥
âœ… ç¼–ç å‰ grep åŒç±» pattern â†’ å†™å®Œé€æ¡å¯¹ç…§ TDD â†’ æ¯ä¸ª except èµ°å˜é‡å¯è¾¾æ€§åˆ†æ
> è¯¦è§ [postmortem-dev-bug-11.md](../postmortems/postmortem-dev-bug-11.md)

### DEV-15 å†™äº† E2E è„šæœ¬ä¸å½“åœºè·‘ â†’ å‡ç»¿äº¤å·®

âŒ å†™äº† E2E è„šæœ¬æ²¡å¯åŠ¨æœåŠ¡å™¨è·‘å°± commitï¼Œmock æµ‹è¯•æ ‡è®°ä¸º"E2E passed"
âœ… E2E è„šæœ¬å†™å®Œå¿…é¡»å½“åœºå¯åŠ¨æœåŠ¡å™¨è·‘ï¼Œçœ‹åˆ°çœŸå® LLM å“åº”æ‰ç®—éªŒè¯ï¼›mock æµ‹è¯•æ ‡è®°ä¸º"é›†æˆæµ‹è¯•"
> è¯¦è§ [postmortem-dev-bug-12.md](../postmortems/postmortem-dev-bug-12.md)

### DEV-16 è°ƒç ”ä»»åŠ¡ä¸²è¡Œæœç´¢ â†’ æµªè´¹æ—¶é—´ï¼Œè¿å CLAUDE.md å¹¶è¡Œè§„åˆ™

âŒ è°ƒç ”"æ— äººå€¼å®ˆå¼€å‘æ¨¡å¼"æ—¶ï¼ŒæŠŠ 4 ä¸ªç‹¬ç«‹å­ä¸»é¢˜ï¼ˆè´¨é‡ä¿éšœã€å¹¶è¡Œå¼€å‘ã€è°ƒåº¦æœºåˆ¶ã€æ¶æ„å¯¹æ¯”ï¼‰å¡è¿› 1 ä¸ª subagent ä¸²è¡Œæœç´¢
âœ… æœç´¢å…³é”®è¯è¶…è¿‡ 2 ç»„æ—¶ï¼Œæ‹†æˆå¤šä¸ªå¹¶è¡Œ Task agent åˆ†å¤´æœç´¢ï¼Œæœ€åæ±‡æ€»
> CLAUDE.md ç¬¬ 72 è¡Œæ˜ç¡®è§„å®š"è°ƒç ”/æœç´¢ä»»åŠ¡å¿…é¡»å¹¶è¡Œ"ã€‚æ ¹å› ï¼šæŠŠè°ƒç ”çœ‹æˆ"ä¸€ä¸ªé—®é¢˜"æ²¡åšä»»åŠ¡åˆ†è§£ã€‚åˆ¤æ–­æ ‡å‡†ï¼šæœç´¢å…³é”®è¯ â‰¥ 2 ç»„ â†’ æ‹†å¹¶è¡Œ agentã€‚

### DEV-17 æ‹¿åˆ°å®æ–½æ–¹æ¡ˆç›´æ¥ç¼–ç ï¼Œè·³è¿‡ PM è¯„å®¡ + ç”¨æˆ·ç¡®è®¤

âŒ M5 æ–¹æ¡ˆå«å¤šä¸ªå¾…ç¡®è®¤å†³ç­–ï¼Œç›´æ¥æ´¾ agent å¼€å¹²ï¼Œä¸­é€”ç”¨æˆ· 3 æ¬¡å˜æ›´å¯¼è‡´è¿”å·¥
âœ… æ‹¿åˆ°æ–¹æ¡ˆåå…ˆæå–æ‰€æœ‰å¾…ç¡®è®¤ç‚¹é€ä¸ªæäº¤ç”¨æˆ·å†³ç­–ï¼›æŒ‰åŠŸèƒ½æ¨¡å—æ‹†å¹¶è¡Œ agent
> DEV-4 + DEV-9 å¤åˆé‡çŠ¯ã€‚æ–¹æ¡ˆè¶Šå®Œæ•´éšå«å‡è®¾è¶Šå¤šï¼Œè¶Šéœ€è¦é€é¡¹ç¡®è®¤ã€‚

### DEV-20 æ’æŸ¥å¤–éƒ¨è¿›ç¨‹é—®é¢˜æ—¶ä¸²è¡Œè¯•é”™ + ä¸éªŒè¯å‰ç½®å‡è®¾ â†’ æ¯è½®ç­‰è¶…æ—¶ç™½è€—æ—¶é—´

âŒ ä¸€æ¬¡åªéªŒè¯ä¸€ä¸ªå‡è®¾ï¼Œæ¯æ¬¡æ’å¢™ç­‰ 3 åˆ†é’Ÿæ‰æ¢æ–¹å‘ï¼›æ”¹äº†é…ç½®æ²¡ç¡®è®¤è¿›ç¨‹è¯»çš„æ˜¯å“ªä»½æ–‡ä»¶
âœ… å…ˆåšç¯å¢ƒå…¨æ™¯æ‰«æï¼ˆproxy/ç›´è¿/é…ç½®è·¯å¾„/è¿›ç¨‹è¯»å“ªä»½ï¼‰ï¼Œå¤šå‡è®¾å¹¶è¡ŒéªŒè¯ä¸ä¸²è¡Œç­‰è¶…æ—¶
> DEV-12 åŒç±»é”™è¯¯ã€‚è¯¦è§ [postmortem-dev-bug-16.md](../postmortems/postmortem-dev-bug-16.md)

### DEV-21 å‡½æ•°è¿”å›å€¼æ‰©å±•åæœªå…¨é‡åŒæ­¥æµ‹è¯• mock/unpack

âŒ `generate_reply` ä» 2 å…ƒç´ æ‰©å±•ä¸º 3 å…ƒç´ ï¼Œ6 ä¸ªæµ‹è¯•æ–‡ä»¶ 10 å¤„ mock/unpack æœªåŒæ­¥
âœ… æ”¹ç­¾ååç«‹å³ `grep -rn "å‡½æ•°å" tests/`ï¼Œæ›´æ–°æ‰€æœ‰ mock `return_value` å’Œ unpack èµ‹å€¼ï¼Œè·‘å…¨é‡æµ‹è¯•
> DEV-6 å¤çŠ¯ã€‚æµ‹è¯•ä»£ç ä¹Ÿæ˜¯è°ƒç”¨æ–¹ï¼Œç­¾åå˜æ›´å¿…é¡» grep ç”Ÿäº§+æµ‹è¯•ä¸¤ä¾§ã€‚

### DEV-22 å‰ç«¯ API è·¯å¾„å‡­è®°å¿†å†™ï¼Œä¸é€æ¡æ¯”å¯¹åç«¯è·¯ç”± â†’ å…¨é‡ 404

âŒ å‰ç«¯ api.ts å‡­è®°å¿†æ‹¼ URLï¼šè·¯å¾„å¤æ•°å½¢å¼é”™ã€HTTP method é”™ã€param ä½ç½®é”™ã€query param åé”™ã€response å­—æ®µåé”™ â€” 6 å¤„å…¨é‡ä¸åŒ¹é…
âœ… å†™å‰ç«¯ API å±‚æ—¶å¿…é¡»æ‰“å¼€åç«¯è·¯ç”±æ–‡ä»¶é€æ¡æ¯”å¯¹ï¼šURL pathã€HTTP methodã€param ä½ç½®ã€response å­—æ®µå
> DEV-11 å‡çº§ç‰ˆã€‚è¯¦è§ [postmortem-dev-bug-17.md](../postmortems/postmortem-dev-bug-17.md)
